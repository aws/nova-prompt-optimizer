import React, { useState } from 'react'
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import { RubricGenerator } from '@/components/evaluation'
import { EvaluationRubric, Dataset } from '@/types'

/**
 * Example component demonstrating how to use the RubricGenerator
 * This shows the complete workflow from dataset analysis to rubric creation
 */
const RubricGeneratorExample: React.FC = () => {
  const [generatedRubric, setGeneratedRubric] = useState<EvaluationRubric | null>(null)
  const [savedRubric, setSavedRubric] = useState<EvaluationRubric | null>(null)

  // Mock dataset for demonstration
  const mockDataset: Dataset = {
    id: 'dataset_1',
    name: 'Customer Support Analysis',
    description: 'Dataset for analyzing customer support responses',
    file_name: 'customer_support.csv',
    file_type: 'csv',
    file_size: 1024000,
    row_count: 500,
    column_names: ['customer_query', 'context', 'support_response', 'satisfaction_rating'],
    input_columns: ['customer_query', 'context'],
    output_columns: ['support_response', 'satisfaction_rating'],
    split_ratio: 0.8,
    train_size: 400,
    test_size: 100,
    metadata: {},
    created_at: '2024-01-15T10:00:00Z',
    updated_at: '2024-01-15T10:00:00Z'
  }

  const handleRubricGenerated = (rubric: EvaluationRubric) => {
    setGeneratedRubric(rubric)
    console.log('Rubric generated:', rubric)
  }

  const handleRubricSaved = (rubric: EvaluationRubric) => {
    setSavedRubric(rubric)
    console.log('Rubric saved:', rubric)
  }

  const resetExample = () => {
    setGeneratedRubric(null)
    setSavedRubric(null)
  }

  return (
    <div className="space-y-6 p-6">
      <Card>
        <CardHeader>
          <CardTitle>Rubric Generator Example</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-4">
            <p className="text-sm text-muted-foreground">
              This example demonstrates the complete rubric generation workflow:
            </p>
            <ol className="list-decimal list-inside space-y-1 text-sm text-muted-foreground">
              <li>Analyze dataset patterns and characteristics</li>
              <li>Generate AI-powered evaluation rubric</li>
              <li>Edit dimensions and scoring criteria</li>
              <li>Preview and test the rubric</li>
              <li>Save the final rubric for annotation tasks</li>
            </ol>
            
            {(generatedRubric || savedRubric) && (
              <Button variant="outline" onClick={resetExample}>
                Reset Example
              </Button>
            )}
          </div>
        </CardContent>
      </Card>

      <RubricGenerator
        dataset={mockDataset}
        onRubricGenerated={handleRubricGenerated}
        onRubricSaved={handleRubricSaved}
      />

      {generatedRubric && (
        <Card>
          <CardHeader>
            <CardTitle>Generated Rubric Summary</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-2">
              <p><strong>Name:</strong> {generatedRubric.name}</p>
              <p><strong>Description:</strong> {generatedRubric.description}</p>
              <p><strong>Dimensions:</strong> {generatedRubric.dimensions.length}</p>
              <p><strong>Generated by AI:</strong> {generatedRubric.generated_by_ai ? 'Yes' : 'No'}</p>
            </div>
          </CardContent>
        </Card>
      )}

      {savedRubric && (
        <Card>
          <CardHeader>
            <CardTitle>Saved Rubric</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-2">
              <p className="text-sm text-green-600">
                âœ“ Rubric has been successfully saved and is ready for annotation tasks
              </p>
              <p><strong>Final Name:</strong> {savedRubric.name}</p>
              <p><strong>Total Dimensions:</strong> {savedRubric.dimensions.length}</p>
            </div>
          </CardContent>
        </Card>
      )}
    </div>
  )
}

export default RubricGeneratorExample